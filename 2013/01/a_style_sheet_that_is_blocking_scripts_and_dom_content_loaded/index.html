<!doctype html>
<html lang="ja" itemscope itemtype="http://schema.org/Blog">
<head>
    <meta charset="utf-8">
  <title>ãƒ¡ãƒ¢ãƒ­ã‚°</title>
  <meta name="description" content="ğŸ’¡ Personal notes about somthing I&#39;m interested in" id="meta-description">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="/blog/css/global.css">
  <script>window.lazyLoadOptions = {};</script>
<link rel="stylesheet" href="/blog/css/prism.css" type="text/css">
<link rel="stylesheet" href="/blog/css/prism-line-numbers.css" type="text/css"></head>
<body>
    <header class="header header_component_global">
    <div class="header__title header__title"><a href="/blog/">ãƒ¡ãƒ¢ãƒ­ã‚°</a></div>
    <p class="header__description">ğŸ’¡ Personal notes about somthing I&#39;m interested in</p>
    <aside><blockquote class="header__epigraph">Well, he fuffed, and he puffed, and he huffed and he puffed, and he puffed and huffed; but he could not get the house down.</blockquote></aside>
    <nav class="navigation navigation-global">
      <a href="/blog/" class="navigation__link">ğŸ“˜ Latest Articles</a>
    </nav>
  </header>
  <div class="container">
    <main class="main">
      <article itemprop="blogPost" itemscope itemType="http://schema.org/BlogPosting">
        <header class="header">
          <h1 class="header__title" itemprop="name">a style sheet that is blocking scripts ã¨ DOMContentLoaded</h1>
          <div>
            <time datetime="2013-01-23T06:07:00.000Z" itemprop="datePublished">
              <span class="calendar-icon">ğŸ“…</span><span>2013å¹´1æœˆ23æ—¥</span>
            </time>
          </div>
          
        </header>
        <div id="article-content" class="content" itemprop="articleBody"><p><a href="http://molily.de/weblog/domcontentloaded" target="_blank" rel="noopener">DOMContentLoaded and stylesheets Â· molily</a>ï¼ˆvia <a href="https://developer.mozilla.org/en-US/docs/Mozilla_event_reference/DOMContentLoaded_&#x25;28event&#x25;29" target="_blank" rel="noopener">DOMContentLoaded - Mozilla event reference | MDN</a>ï¼‰ã«ã¦ã€headå†…ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚·ãƒ¼ãƒˆã¨Javascriptã®é…ç½®ã®é•ã„ã§ã€DOMContentLoadedã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç”Ÿã™ã‚‹ã‚¿ã‚¤ãƒŸãƒ³ã‚°ãŒå¤‰ã‚ã‚‹ã¨ã„ã†å†…å®¹ãŒæ²è¼‰ã•ã‚Œã¦ã„ã¾ã™ã€‚ã‚¹ã‚¿ã‚¤ãƒ«ã‚·ãƒ¼ãƒˆã®ã‚ã¨ã«JavascriptãŒå…¥ã£ã¦ã„ã‚‹ã¨ã€DOMContentLoadedã¯ã‚¹ã‚¿ã‚¤ãƒ«ã‚·ãƒ¼ãƒˆã‚’ãƒ­ãƒ¼ãƒ‰ã—ãŸã‚ã¨ã«ç™ºç”Ÿã—ã¦ã€ã‚¹ã‚¿ã‚¤ãƒ«ã‚·ãƒ¼ãƒˆã®ã‚ã¨ã«JavascriptãŒãªã„ã¨ã€ã‚¹ã‚¿ã‚¤ãƒ«ã‚·ãƒ¼ãƒˆã®ãƒ­ãƒ¼ãƒ‰ã‚’å¾…ãŸãšã«DOMContentLoadedãŒç™ºç”Ÿã™ã‚‹ã€‚</p>
<a id="more"></a>
<p>ã“ã‚Œã¯<a href="http://www.w3.org/TR/html5/syntax.html#parsing-main-incdata" target="_blank" rel="noopener">Parsingã®ä»•æ§˜</a>ã«ã‚ˆã‚‹ã¨ã€<a href="http://www.w3.org/TR/html5/scripting-1.html#pending-parsing-blocking-script" target="_blank" rel="noopener">pending parsing-blocking script</a>ã®å®Ÿè¡Œå‰ã«ã€DocumentãŒ <a href="http://www.w3.org/TR/html5/document-metadata.html#has-no-style-sheet-that-is-blocking-scripts" target="_blank" rel="noopener">has no style sheet that is blocking scripts</a>ã®çŠ¶æ…‹ã«ãªã‚‹ã¾ã§ã€<a href="http://www.w3.org/TR/html5/webappapis.html#spin-the-event-loop" target="_blank" rel="noopener">event loopã‚’spinã•ã›ã‚‹</a>ã‹ã‚‰ã¨ã„ã†ã“ã¨ã«ãªã‚‹ã¿ãŸã„ã€‚</p>
<blockquote>
<p>If the parserâ€™s Document has a style sheet that is blocking scripts or the scriptâ€™s â€œready to be parser-executedâ€ flag is not set: spin the event loop until the parserâ€™s Document has no style sheet that is blocking scripts and the scriptâ€™s â€œready to be parser-executedâ€ flag is set.</p>
</blockquote>
<p>ã¤ã¾ã‚Šã€pending parsing-blocking scriptï¼ˆHTMLãƒ‘ãƒ¼ã‚µãƒ¼ãŒinsertã—ãŸscriptã‚¿ã‚°ã®ã†ã¡ã€deferã‚„asyncå±æ€§ãŒã¤ã„ã¦ã„ãªã„ã‚‚ã®ï¼‰ãŒå®Ÿè¡Œå‰ã«ã€style sheet that is blocking scriptsï¼ˆHTMLãƒ‘ãƒ¼ã‚µãƒ¼ãŒè¿½åŠ ã—ãŸã‚¹ã‚¿ã‚¤ãƒ«ã‚·ãƒ¼ãƒˆã®ã†ã¡ã€ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ãªã„ã‚‚ã®ï¼ˆstyle sheet ready flag is not yet setï¼‰ï¼‰ãŒã‚ã‚‹å ´åˆã€ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã‚‹ã¾ã§<a href="http://www.w3.org/TR/html5/webappapis.html#processing-model-3" target="_blank" rel="noopener">event loopã‚’ã¾ã‚ã™</a>ã€‚ã‚¹ã‚¿ã‚¤ãƒ«ã‚·ãƒ¼ãƒˆãŒãƒ­ãƒ¼ãƒ‰ã•ã‚Œã€style sheet readyã®çŠ¶æ…‹ã«ãªã‚‹ã¨ã€event loopã®ã€Œupdate the renderingã€ã®ã‚¹ãƒ†ãƒƒãƒ—ã§scriptã§ã®åˆ©ç”¨ãŒå¯èƒ½ãªçŠ¶æ…‹ã«ãªã‚Šã€ä»–ã«ãƒ­ãƒ¼ãƒ‰å¾…ã¡ãŒãªã‘ã‚Œã°scriptã®å®Ÿè¡Œã«ç§»ã‚‹ã¨ã€‚ã“ã†ã™ã‚‹ã“ã¨ã§ã€ã‚¹ã‚¿ã‚¤ãƒ«ã‚·ãƒ¼ãƒˆã§æŒ‡å®šã—ã¦ã„ã‚‹ãƒ•ã‚©ãƒ³ãƒˆã®è‰²ãªã‚“ã‹ã®å€¤ã‚’ã€scriptãŒé©åˆ‡ã«å—ã‘å–ã‚‹ã“ã¨ãŒã§ãã‚‹ã¨ã€‚</p>
<p>DOMContentLoadedã®ã‚¤ãƒ™ãƒ³ãƒˆã¯ã€<a href="http://www.w3.org/TR/html5/syntax.html#the-end" target="_blank" rel="noopener">8.2.6 The end</a>ã«è¨˜è¼‰ã«ã‚ˆã‚Œã°ã€HTMLã®ãƒ‘ãƒ¼ã‚¹ãŒä¸€é€šã‚Šå®Œäº†ã—ã¦ã€deferå±æ€§ãŒã¤ã„ãŸscriptãªã©ã‚’å‡¦ç†ã—ãŸã‚ã¨ã«ç™ºç”Ÿã™ã‚‹ã€‚ã®ã§ã€ã‚¹ã‚¿ã‚¤ãƒ«ã‚·ãƒ¼ãƒˆã®å¾Œã«scriptãŒã‚ã‚‹å ´åˆã€scriptãŒãƒ‘ãƒ¼ã‚µãƒ¼ã‚’ãƒ–ãƒ­ãƒƒã‚¯ã—ã¤ã¤ã‚¹ã‚¿ã‚¤ãƒ«ã‚·ãƒ¼ãƒˆã®ãƒ­ãƒ¼ãƒ‰ã‚’å¾…ã£ãŸä¸Šã§å®Ÿè¡Œã•ã‚Œã‚‹ãŸã‚ã€DOMContentLoadedã¯ã‚¹ã‚¿ã‚¤ãƒ«ã‚·ãƒ¼ãƒˆãŒãƒ­ãƒ¼ãƒ‰ã•ã‚Œã‚‹ã¾ã§å¾…ã¤ã“ã¨ã«ãªã‚‹ã€‚ä¸€æ–¹ã€ã‚¹ã‚¿ã‚¤ãƒ«ã‚·ãƒ¼ãƒˆã®å¾Œã«scriptãŒãªã„å ´åˆã¯ã€ãƒ‘ãƒ¼ã‚µãƒ¼ã‚’ãƒ–ãƒ­ãƒƒã‚¯ã—ã¦ãƒ­ãƒ¼ãƒ‰ã‚’å¾…ã¤ã“ã¨ãŒãªã„ãŸã‚ã€ãƒ­ãƒ¼ãƒ‰ãŒå®Œäº†ã—ã¦ã„ãªãã¦ã‚‚ã€HTMLãƒ‘ãƒ¼ã‚¹ãŒå®Œäº†ã—ã¦DOMContentLoadedã®ã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç”Ÿã™ã‚‹ã€‚ã¨ã€ã„ã†ã“ã¨ã«ãªã‚‹ã€‚ã¿ãŸã„ã€‚</p>
<p>ãŸã ã€<a href="http://molily.de/weblog/domcontentloaded" target="_blank" rel="noopener">DOMContentLoaded and stylesheets Â· molily</a>ã®<a href="http://molily.de/assets/domcontentloaded/t2-link-external-script.html" target="_blank" rel="noopener">Testcase #2</a>ã§è©¦ã—ãŸæ„Ÿã˜ã§ã¯ã€Operaã¯scriptã®å®Ÿè¡Œå‰ã«ã‚¹ã‚¿ã‚¤ãƒ«ã‚·ãƒ¼ãƒˆã®ãƒ­ãƒ¼ãƒ‰ã‚’å¾…ãŸãªã„é›°å›²æ°—ã€‚ãã®ãŸã‚DOMContentLoadedã®å®Ÿè¡ŒãŒãƒ­ãƒ¼ãƒ‰ã‚ˆã‚Šæ—©ãã€getComputedStyleã§å–å¾—ã—ãŸãƒ•ã‚©ãƒ³ãƒˆã®è‰²ã®å€¤ã«ã‚¹ã‚¿ã‚¤ãƒ«ã‚·ãƒ¼ãƒˆã§è¨­å®šã—ãŸè‰²ãŒåæ˜ ã§ãã¦ã„ãªã„ï¼ˆä»–ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯headã®éƒ¨åˆ†ã§ãƒ‘ãƒ¼ã‚µãƒ¼ãŒãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã‚‹ã®ã§ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã¾ã§ã«æ™‚é–“ãŒã‹ã‹ã‚‹ï¼‰ã€‚</p>
<p>Operaã®å‹•ä½œã®å·®ç•°ã‚’æ°—ã«ã—ãªã„ã¨ã—ã¦ã‚‚ã€scriptã®å®Ÿè¡Œæ™‚ï¼ˆãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ™‚ã§ã¯ãªã„ï¼‰ã«ã‚¹ã‚¿ã‚¤ãƒ«ã‚·ãƒ¼ãƒˆãŒavailableãªçŠ¶æ…‹ã«ãªã£ã¦ã„ãªã„ã¨ã€å®Ÿè¡Œã¯ãƒ–ãƒ­ãƒƒã‚¯ã•ã‚ŒãŸçŠ¶æ…‹ã«ãªã‚‹ã®ã§ã€ã‚¹ã‚¿ã‚¤ãƒ«ã‚·ãƒ¼ãƒˆã®ãƒ­ãƒ¼ãƒ‰ã‚’ã§ãã‚‹ã ã‘å…ˆã«ã—ã¦ã€javascriptã¯ã§ãã‚‹ã ã‘å¾Œã«ã™ã‚‹ã€ã¨ã„ã†ã®ãŒåŸºæœ¬çš„ã«ã¯è‰¯ã„ã‹ã‚‚ã—ã‚Œãªã„ã€‚</p>
<p>scriptã§ç¾åœ¨ã®ã‚¹ã‚¿ã‚¤ãƒ«ã®å€¤ã‚’ã¾ã£ãŸãå‚ç…§ã—ãªã„ã¿ãŸã„ãªã€ã‚¹ã‚¿ã‚¤ãƒ«ã‚·ãƒ¼ãƒˆã¨scriptã‚’ç‹¬ç«‹ã§ãã‚‹ã®ã§ã‚ã‚Œã°ã€scriptã‚’å…ˆã«èª­ã¿è¾¼ã‚€ã¨ã„ã†ã®ã‚‚ã‚ã‚Šã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ï¼ˆãã®æ–¹ãŒãƒ­ãƒ¼ãƒ‰ã«ã‚ˆã‚‹ãƒ–ãƒ­ãƒƒã‚¯ã¯ç™ºç”Ÿã—ãªã„ï¼‰ã€‚ãŸã ã€Safari(6)ã¨Chrome(24)ã§ã¯ã€çµå±€ã‚¹ã‚¿ã‚¤ãƒ«ã‚·ãƒ¼ãƒˆãŒãƒ­ãƒ¼ãƒ‰ã—çµ‚ã‚ã‚‹ã¾ã§ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒè¡¨ç¤ºã•ã‚Œãªã‹ã£ãŸã§ã™ãŒâ€¦ï¼ˆFirefoxã¯è¡¨ç¤ºã•ã‚Œã‚‹ï¼‰</p>
</div>
      </article>
    </main>
  </div>
  <script src="/blog/js/lazysizes/lazysizes.min.js" async></script>
<script type="text/javascript">
  // http://css-tricks.com/favicons-next-to-external-links/
  for (const article of document.getElementsByTagName('article')){
    for (const link of article.getElementsByTagName('a')){
      const hostname = link.hostname;
      if (hostname === location.hostname) { continue; }
      link.style.background = `url(http://www.google.com/s2/favicons?domain=${hostname}) 4px center no-repeat`;
      link.style.paddingLeft = '24px';
    }
  }
</script>
</body>
</html>