<!doctype html>
<html lang="ja" itemscope itemtype="http://schema.org/Blog">
<head>
    <meta charset="utf-8">
  <title>ãƒ¡ãƒ¢ãƒ­ã‚°</title>
  <meta name="description" content="ğŸ’¡ Personal notes about somthing I&#39;m interested in" id="meta-description">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="/blog/css/global.css">
  <script>window.lazyLoadOptions = {};</script>
<link rel="stylesheet" href="/blog/css/prism.css" type="text/css">
<link rel="stylesheet" href="/blog/css/prism-line-numbers.css" type="text/css"></head>
<body>
    <header class="header header_component_global">
    <div class="header__title header__title"><a href="/blog/">ãƒ¡ãƒ¢ãƒ­ã‚°</a></div>
    <p class="header__description">ğŸ’¡ Personal notes about somthing I&#39;m interested in</p>
    <aside><blockquote class="header__epigraph">Well, he fuffed, and he puffed, and he huffed and he puffed, and he puffed and huffed; but he could not get the house down.</blockquote></aside>
    <nav class="navigation navigation-global">
      <a href="/blog/" class="navigation__link">ğŸ“˜ Latest Articles</a>
    </nav>
  </header>
  <div class="container">
    <main class="main">
      <article itemprop="blogPost" itemscope itemType="http://schema.org/BlogPosting">
        <header class="header">
          <h1 class="header__title" itemprop="name">grunt-contrib-connect ã‚¿ã‚¹ã‚¯ã§ CORS ã‚’æœ‰åŠ¹ã«ã™ã‚‹</h1>
          <div>
            <time datetime="2013-07-31T02:00:00.000Z" itemprop="datePublished">
              <span class="calendar-icon">ğŸ“…</span><span>2013å¹´7æœˆ31æ—¥</span>
            </time>
          </div>
          
        </header>
        <div id="article-content" class="content" itemprop="articleBody"><p><a href="https://github.com/gruntjs/grunt-contrib-jasmine" target="_blank" rel="noopener">grunt-contrib-jasmine</a>ã®Third party templatesã«ã‚ã‚‹<a href="https://github.com/maenu/grunt-template-jasmine-istanbul" target="_blank" rel="noopener">Code coverage output with Istanbul</a>ã‚’ä½¿ã£ã¦jasmineãƒ†ã‚¹ãƒˆã®coverageã®è¨ˆæ¸¬ã‚’ã—ã‚ˆã†ã¨ã—ã¦ã„ã‚‹ã®ã§ã™ãŒã€XMLHttpRequestã‚’å®Ÿè¡Œã™ã‚‹ã¨ã“ã‚ã§Cross Originã®åˆ¶ç´„ã«ã²ã£ã‹ã‹ã£ã¦ã‚¨ãƒ©ãƒ¼ã«ãªã£ã¦ã—ã¾ã†ã€‚localhostã§å®Ÿè¡Œã•ã‚Œã‚‹ã®ãŒç†ç”±ã‹ãªã¨ã¯æ€ã‚ã‚Œã‚‹ã®ã§ã™ãŒã€æ™®é€šã«jasmineãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ãŸå ´åˆã¯ã²ã£ã‹ã‹ã‚‰ãªã„ä¸æ€è­°â€¦ï¼ˆã‚¨ãƒ©ãƒ¼ã«ã€Œfile://ã€ãŒå‡ºã¦ã„ã‚‹ã®ã‚‚ä¸æ˜ï¼‰ jasmineã®coverageç”¨ã®ã‚¿ã‚¹ã‚¯ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§hostã‚’localhostã«æŒ‡å®šã—ã¦ã„ãªã‹ã£ãŸãŸã‚ã ã£ãŸã€‚ãã®ãŸã‚ã€localfile system (file://) ã§èµ·å‹•ã—ã¦ã„ãŸâ€¦ è¨­å®šã‚’è¿½åŠ ã—ãŸã‚‰CORSã®è¨­å®šã¯å¿…è¦ãªã‹ã£ãŸã€‚</p>
<a id="more"></a>
<p>XMLHttpRequest cannot load <a href="http://localhost:9002/foobar.js" target="_blank" rel="noopener">http://localhost:9002/foobar.js</a>.<br>Origin file:// is not allowed by Access-Control-Allow-Origin.</p>
<p>ç†ç”±ã¯ã•ã¦ãŠãã€Access-Control-Allow-Originï¼ˆ<a href="https://developer.mozilla.org/ja/docs/HTTP_access_control" target="_blank" rel="noopener">HTTP access control (CORS)</a>å‚è€ƒï¼‰ã‚’è¨­å®šã™ã‚Œã°ã€ã‚¨ãƒ©ãƒ¼ã‚’æŠ‘åˆ¶ã§ãã‚‹ã¯ãšï¼ˆ<a href="http://stackoverflow.com/questions/10143093/origin-is-not-allowed-by-access-control-allow-origin" target="_blank" rel="noopener">javascript - Origin is not allowed by Access-Control-Allow-Origin - Stack Overflow</a>ã‚‚å‚è€ƒï¼‰ã€‚<a href="https://github.com/gruntjs/grunt-contrib-connect" target="_blank" rel="noopener">grunt-contrib-connect</a>ã§ã‚µãƒ¼ãƒãƒ¼ã‚’ç«‹ã¡ä¸Šã’ã¦PhantomJSãŒãã“ã‹ã‚‰Jasmine specsã‚’å®Ÿè¡Œã™ã‚‹ã‚ˆã†ã«ã—ã¦ã„ã‚‹ã®ã§ã€grunt-contrib-connectã«CORSã®è¨­å®šã‚’ã™ã‚‹ã€‚</p>
<p>grunt-contrib-connectã§ç«‹ã¡ä¸Šã’ãŸã‚µãƒ¼ãƒãƒ¼ã®headerã«Access-Control-Allow-Originã‚’è¿½åŠ ã™ã‚‹ã«ã¯â€¦ middlewareã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ã†ã¨è‰¯ã„ã‚‰ã—ã„ã€‚middlewareã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ã€returnã«functionã®é…åˆ—ã‚’æ¸¡ã™ã“ã¨ã§ã€æ¸¡ã—ãŸfunctionã‚’é †ç¹°ã‚Šå®Ÿè¡Œã—ã¦ãã‚Œã‚‹ã¿ãŸã„ã€‚Access-Control-Allow-Originã®è¿½åŠ æ–¹æ³•ã¯ã€<a href="https://gist.github.com/Vp3n/5340891" target="_blank" rel="noopener">Allowing CORS (Cross-Origin Resource Sharing) requests from grunt server</a>ã‚’å‚è€ƒã«ã—ã¾ã—ãŸã€‚ã“ã®Gistã®ã ã‘ã ã¨ã€<a href="https://github.com/gruntjs/grunt-contrib-connect/blob/master/tasks/connect.js" target="_blank" rel="noopener">grunt-contrib-connectã®ã‚¿ã‚¹ã‚¯ã§ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§è¨­å®šã•ã‚Œã¦ã„ã‚‹middleware</a>ãŒå®Ÿè¡Œã•ã‚Œãªããªã£ã¦ã—ã¾ã†ã®ã§ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§è¨­å®šã•ã‚Œã¦ã„ã‚‹functionã‚‚ä¸€ç·’ã«è¿½åŠ ã™ã‚‹ã€‚ã™ã‚‹ã¨ã€ã“ã‚“ãªæ„Ÿã˜ã®è¨­å®šã«ãªã‚‹ã€‚</p>
<p>test: {<br>  options: {<br>    hostname: â€˜localhostâ€™,<br>    port: 9002,<br>    keepalive: true,<br>    middleware: function (connect, options) {<br>      return [<br>        function (req, res, next) {<br>          res.setHeader(â€˜Access-Control-Allow-Originâ€™, â€˜<em>â€˜);<br>          res.setHeader(â€˜Access-Control-Allow-Methodsâ€™, â€˜</em>â€˜);<br>          next();<br>        },<br>        // Serve static files.<br>        connect.static(options.base),<br>        // Make empty directories browsable.<br>        connect.directory(options.base)<br>      ];<br>    }<br>  }<br>},</p>
<p>ã“ã‚Œã§Cross Originã®ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹ã“ã¨ãªãã€coverageã®è¨ˆæ¸¬ãŒå®Œäº†ã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚</p>
<p>ã¨ã„ã†ãƒ¡ãƒ¢</p>
</div>
      </article>
    </main>
  </div>
  <script src="/blog/js/lazysizes/lazysizes.min.js" async></script>
</body>
</html>