<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>The Little Code Bricks</title>
  <meta name="description" content="The Little Code Bricks aims to provide some piece of code which make solid web site/application 🔧" id="meta-description">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="css/global.css">
</head>
<body>
  <main class="main">
  <header class="header">
    <h1 class="header__title">Gatsbyでスタティックサイトを作成する</h1>
  </header>
  <div id="article-content" class="content"><p>更新しなくなったブログをリニューアルしようと思って、<a href="https://www.gatsbyjs.org" target="_blank" rel="noopener">Gatsby</a> で構築しようと思い立って、今作成してみている。</p>
<p>Gatsbyは「Blazing-fast static site generator for React」ということで、Reactベースのスタティックサイトジェネレータらしいのだけど、実のところまだよくわかっていない。<a href="https://www.gatsbyjs.org/docs/" target="_blank" rel="noopener">Getting Started</a> のドキュメントをみて、<a href="https://github.com/gatsbyjs/gatsby-starter-blog" target="_blank" rel="noopener">gatsby-starter-blog</a> のstarterをGithub pages で公開しているだけなのだ。</p>
<p>とはいえ、一応最初に行ったことをそのまま書き記しておこうと思う。</p>
<h3 id="nvmで-Node-9-xをインストール"><a href="#nvmで-Node-9-xをインストール" class="headerlink" title="nvmで Node 9.xをインストール"></a>nvmで Node 9.xをインストール</h3><p>インストール時か<code>gatsby develop</code>のときか失念してしまったが、どこかのタイミングで<code>error serve@6.4.3: The engine &quot;node&quot; is incompatible with this module. Expected version &quot;&gt;=6.9.0&quot;.</code>というエラーが発生してしまったので、ローカル環境に9.2をインストール（今確認したらすでに最新は9.3だったが）。<a href="https://github.com/creationix/nvm" target="_blank" rel="noopener">nvm</a>はだいぶ前にインストールしたのでどうインストールしたか失念。<a href="https://brew.sh/" target="_blank" rel="noopener">Homebrew</a>でインストールしたのかもしれない。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nvm install 9</span><br><span class="line">nvm <span class="built_in">alias</span> default 9</span><br></pre></td></tr></table></figure>
<p>デフォルトの設定を6.xにしていたのだけど、これを機にローカルで使用するバージョンは9.xに変更した。</p>
<h3 id="Gatsby-CLI-のインストール-とサイトの作成"><a href="#Gatsby-CLI-のインストール-とサイトの作成" class="headerlink" title="Gatsby CLI のインストール とサイトの作成"></a>Gatsby CLI のインストール とサイトの作成</h3><p>ここから先は基本的には<a href="https://www.gatsbyjs.org/docs/" target="_blank" rel="noopener">Gatsby getting started</a>と同じことをただやった。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install -g gatsby-cli</span><br><span class="line">gatsby new memolog https://github.com/gatsbyjs/gatsby-starter-blog</span><br></pre></td></tr></table></figure>
<h3 id="Github-Pages-へのデプロイ"><a href="#Github-Pages-へのデプロイ" class="headerlink" title="Github Pages へのデプロイ"></a>Github Pages へのデプロイ</h3><p>Github pagesにデプロイするためにレポジトリをGithub上で作成して、レポジトリを設定。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git init</span><br><span class="line">git remote add origin git@github.com:memolog/site.git</span><br><span class="line">git add .</span><br><span class="line">git commit</span><br><span class="line">git push origin master</span><br></pre></td></tr></table></figure>
<p>そのあと、 <a href="https://www.gatsbyjs.org/docs/deploy-gatsby/#github-pages" target="_blank" rel="noopener">Deploying Getsby</a>の内容にしたがって、Github Pagesへのデプロイ準備<br><a href="https://yarnpkg.com/docs/install" target="_blank" rel="noopener">Yarn</a>はいつインストールしたか失念したが、<code>brew install yarn --without-node</code> でインストールしたと思う。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yarn add gh-pages --dev</span><br><span class="line">yarn deploy</span><br></pre></td></tr></table></figure>
<p>これで完了。いまのところデフォルトのテンプレートそのままなので、これからその辺りを更新していこうと思う。とりあえずプロフィール画像だけでも変更しておきたい。</p>
<p>個人的にはカスタムドメインを使用したかっただけど、SSL証明書の関係や、Amazon S3とCloudFront、Route53で新しいドメイン用意しても、個人サイトのトラフィックだとたいしてお金かからないらしいのだけど、個人サイトだし、いつ気が変わってやめるかもわからないし、お金かけずにやる方がいいかなと思ってgithub.ioをそのまま使うことにした。</p>
<p>（テスト投稿するつもりだけだったのに無駄に文字を書き連ねてしまった）</p>
<hr>
<p>ちなみにこの文章を書いているエディタはVisual Code Basicを使用しているが、以前にSlack Appでも問題があった<a href="https://github.com/electron/electron/issues/9173" target="_blank" rel="noopener">Electronで日本語入力でバックスペースすると文字化けする問題</a>が残っていて、少々辛い。<a href="https://github.com/Microsoft/vscode/blob/master/package.json" target="_blank" rel="noopener">Visual Code Base のソース</a>を見ると、Electron 1.7.0 を使用している雰囲気だが、1.7でもまだ問題が残っているということなのでしょう。現状のステータスがよくわからないけど、公開前に不要な文字を消すように何か対策を考えようと今は思っている（何もしないかもしれないけど）。</p>
</div>
</main>

</body>
</html>